<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ASVARIUS Kernel - PCjs</title>
  <style>
    body { background: #000; color: #0f0; font-family: monospace; margin: 0; }
    header { padding: 12px 16px; border-bottom: 1px solid #0f0; display:flex; align-items:center; justify-content:space-between; }
    .btn { color:#000; background:#0f0; border:none; padding:8px 12px; cursor:pointer; font-weight:700; }
    .btn.secondary { background:#111; color:#0f0; border:1px solid #0f0; }
    .wrap { padding: 16px; }
    #pcjs, iframe { width: 100%; height: calc(100vh - 100px); border: 0; background:#111; }
    .note { color:#aaa; font-size: 13px; margin-top: 10px; }
    pre { white-space: pre-wrap; }
  </style>
</head>
<body>
  <header>
    <div>üñ•Ô∏è ASVARIUS Kernel via PCjs</div>
    <div>
      <a class="btn secondary" href="./index.html">Voltar</a>
      <button class="btn" id="openBtn">Abrir em nova aba</button>
    </div>
  </header>
  <div class="wrap">
    <div id="status">Preparando PCjs...</div>
    <div id="pcjs-container"></div>
    <div class="note">
      Se o embed n√£o carregar, use o bot√£o "Abrir em nova aba".
    </div>
  </div>

  <script>
    // Tentativa 1: usar o servi√ßo de embed do PCjs apontando para nosso ISO
    // Observa√ß√£o: Alguns navegadores bloqueiam fetch de blob via iframe data URL.
    // Como alternativa, abrimos o PCjs em uma nova aba, pedindo para o usu√°rio selecionar o ISO local via UI.

    const isoURL = './asvarius.iso';

    function openPCjsNewTab() {
      // Abre a p√°gina do PCjs (DOS/PC AT) em nova aba.
      // Usu√°rio pode carregar o ISO manualmente (Use menu do PCjs: Disks/CD-ROM -> Load...).
      window.open('https://www.pcjs.org/machines/pcx86/ibm/5170/vga/1024kb/', '_blank');
    }

    document.getElementById('openBtn').addEventListener('click', openPCjsNewTab);

    async function tryEmbed() {
      const status = document.getElementById('status');
      try {
        // Verifica se ISO est√° dispon√≠vel
        const resp = await fetch(isoURL, { method: 'HEAD' });
        if (!resp.ok) {
          status.textContent = 'ISO n√£o encontrado. Aguarde o build do CI ou compile localmente.';
          return;
        }
        status.textContent = 'ISO encontrado. Tentando embed...';

        // Embed simples via iframe do PCjs (carregado com config padr√£o)
        const iframe = document.createElement('iframe');
        iframe.src = 'https://www.pcjs.org/machines/pcx86/ibm/5170/vga/1024kb/';
        iframe.loading = 'lazy';
        iframe.referrerPolicy = 'no-referrer';
        document.getElementById('pcjs-container').appendChild(iframe);

        // Nota: PCjs n√£o suporta carregar ISO remoto sem integra√ß√£o custom via config JSON hospedado.
        // Como workaround, instru√≠mos o usu√°rio a abrir em nova aba e fazer Load do ISO.
        const note = document.createElement('div');
        note.className = 'note';
        note.innerHTML = `
          Dica: Dentro do PCjs, abra o menu Disks/CD-ROM &rarr; Load... e selecione o arquivo <code>asvarius.iso</code> desta p√°gina.<br>
          Se o navegador bloquear o acesso cruzado, baixe o ISO: <a href="${isoURL}" download>baixar asvarius.iso</a>.
        `;
        document.querySelector('.wrap').appendChild(note);

      } catch (e) {
        status.textContent = 'Falha ao embutir PCjs. Abra em nova aba.';
      }
    }

    tryEmbed();
  </script>
</body>
</html>
